# Erlauben von eingehendem DNS-Verkehr (UDP und TCP) an den BIND-Server
sudo iptables -A INPUT -p udp --dport 53 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 53 -j ACCEPT

# Erlauben von DNS-Verkehr aus dem internen Netzwerk
sudo iptables -A INPUT -s 192.168.0.0/24 -p udp --dport 53 -j ACCEPT
sudo iptables -A INPUT -s 192.168.0.0/24 -p tcp --dport 53 -j ACCEPT

# Erlauben von ausgehendem DNS-Verkehr an die Forwarder (Quad9 und OpenDNS)
sudo iptables -A OUTPUT -p udp -d 9.9.9.9 --dport 53 -j ACCEPT
sudo iptables -A OUTPUT -p udp -d 208.67.222.222 --dport 53 -j ACCEPT
sudo iptables -A OUTPUT -p udp -d 208.67.220.220 --dport 53 -j ACCEPT

# Erlauben von ausgehendem DNS-Verkehr an die Forwarder über TCP
sudo iptables -A OUTPUT -p tcp -d 9.9.9.9 --dport 53 -j ACCEPT
sudo iptables -A OUTPUT -p tcp -d 208.67.222.222 --dport 53 -j ACCEPT
sudo iptables -A OUTPUT -p tcp -d 208.67.220.220 --dport 53 -j ACCEPT

# Standardmäßig DROP für alle anderen eingehenden Verbindungen
sudo iptables -A INPUT -j DROP
